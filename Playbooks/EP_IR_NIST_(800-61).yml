id: EP_IR_NIST (800-61)
version: 3
contentitemexportablefields:
  contentitemfields:
    packID: SOCOptimization
    packName: SOC Framework
    itemVersion: 2.1.1
    fromServerVersion: ""
    toServerVersion: ""
    definitionid: ""
    prevname: ""
    isoverridable: false
    supportedModules: []
vcShouldKeepItemLegacyProdMachine: false
name: EP_IR_NIST (800-61)
fromversion: 5.0.0
description: |-
  This Entry Point playbook acts as the first stage of the alert response pipeline. It is designed to be assigned directly to the automation trigger so that every new alert entering the SOC Framework is handled in a standardized way.

  Key functions:

  Upon Trigger Handling – Calls the Foundation – Upon Trigger playbook to initialize context, clear routing data, and set global variables.

  Alert Classification – Matches the incoming alert’s MITRE ATT&CK tactic or category against the Playbook Deployment Matrix to determine the appropriate response path.

  Routing to Lifecycle – Once classified, passes control to the top-level SOC NIST IR (800-61) playbook, which orchestrates the NIST alert response phases (Preparation, Detection & Analysis, Containment, Eradication, Recovery, and Post-Alert).

  This playbook ensures that every alert begins consistently, with normalization and routing handled before entering the NIST IR lifecycle. It effectively connects the raw automation trigger to the structured NIST response process, enabling modular blue/green deployment and tool-agnostic playbook execution
tags:
- MITRE
- SOC
- SOC_Framework
- NIST 800-61
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c6580e49-dceb-4340-8867-666b7738078e
    type: start
    task:
      id: c6580e49-dceb-4340-8867-666b7738078e
      version: -1
      name: ""
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: d8799f66-e47d-409b-82e2-478b0708e021
    type: title
    task:
      id: d8799f66-e47d-409b-82e2-478b0708e021
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 4c8ad714-05b0-47d7-b310-52e26e7d0446
    type: playbook
    task:
      id: 4c8ad714-05b0-47d7-b310-52e26e7d0446
      version: -1
      name: Foundation - Upon Trigger
      playbookName: Foundation - Upon Trigger
      type: playbook
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 50,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 76c5a726-b817-44a1-a7b2-18123234509d
    type: condition
    task:
      id: 76c5a726-b817-44a1-a7b2-18123234509d
      version: -1
      name: Normalized Alert Categories?
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      "no":
      - "3"
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AlertCategories
            iscontext: true
    - label: "no"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: AlertCategories
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: cd14c308-db43-4c73-85e2-23bc1d26553f
    type: playbook
    task:
      id: cd14c308-db43-4c73-85e2-23bc1d26553f
      version: -1
      name: SOC NIST IR (800-61)
      description: |-
        This playbook implements the NIST SP 800-61 Alert Response lifecycle in a structured, repeatable way. It serves as the top-level controller, orchestrating all downstream playbooks and automations that align to the four NIST phases:

        Preparation – Normalize and stage context (entities, products, alert categories) to ensure consistent execution.

        Detection & Analysis – Trigger enrichment and investigation playbooks (endpoint, network, identity, email, cloud) based on normalized entities and mapped MITRE ATT&CK tactics.

        Containment, Eradication, Recovery – Call the appropriate static or product-specific playbooks to contain threats, remove malicious artifacts, and restore systems.

        Post-Alert Activity – Document lessons learned, update playbook routing matrices, and feed back into SOC optimization.

        The design emphasizes modularity and flexibility:

        Each NIST phase is represented as a dedicated section or sub-playbook, making it easy to swap out or extend tools.

        Normalization (Upon Trigger of the EntryPoint) ensures entities (hosts, users, IPs, processes, etc.) are handled consistently.

        This top-level playbook is the backbone of the SOC Framework: it receives the alert trigger, applies the NIST 800-61 model, and routes execution to the appropriate detection, containment, and response sub-playbooks for standardized alert handling
      playbookName: SOC NIST IR (800-61)
      type: playbook
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      ShadowMode:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
system: true
view: |-
  {
    "linkLabelsPosition": {
      "14_15_yes": 0.9
    },
    "paper": {
      "dimensions": {
        "height": 770,
        "width": 492.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: EntryPoint
  value:
    simple: EP_InitialAccess
  required: false
  description: ""
  playbookInputQuery: null
inputSections:
- inputs:
  - EntryPoint
  name: General (Inputs group)
  description: Generic group for inputs
outputSections:
- outputs: []
  name: General (Outputs group)
  description: Generic group for outputs
outputs: []
sourceplaybookid: 51ffcd5a-f5bb-4e09-84ae-e1efdc5165ac
dirtyInputs: true
adopted: true
