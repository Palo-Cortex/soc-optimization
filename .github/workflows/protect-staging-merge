name: Protect staging from unauthorized merges

on:
  pull_request:
    branches:
      - staging

jobs:
  restrict-staging-source:
    runs-on: ubuntu-latest
    steps:
      - name: Enforce allowed source branches into staging
        run: |
          SRC="${{ github.head_ref }}"
          echo "PR source branch: $SRC"

          if [[ "$SRC" == "develop" ]]; then
            echo "✅ Allowed source branch into staging."
            exit 0
          fi

          echo "❌ PRs into staging must come from 'develop'."
          exit 1
